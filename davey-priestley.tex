% Document setup
\documentclass[article, a4paper, 11pt, oneside]{memoir}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[UKenglish]{babel}

% Document info
\newcommand\doctitle{Davey \& Priesley, \emph{Introduction to Lattices and Order}}
\newcommand\docauthor{Danny Nygård Hansen}

% Formatting and layout
\usepackage[autostyle]{csquotes}
\usepackage[final]{microtype}
\usepackage{xcolor}
\frenchspacing
\usepackage{latex-sty/articlepagestyle}
\usepackage{latex-sty/articlesectionstyle}
% \usepackage{latex-sty/amalgsymbol}

% Fonts
\usepackage[largesmallcaps]{kpfonts}
\DeclareSymbolFontAlphabet{\mathrm}{operators} % https://tex.stackexchange.com/questions/40874/kpfonts-siunitx-and-math-alphabets
\linespread{1.06}
\let\mathfrak\undefined
\usepackage{eufrak}
\usepackage{inconsolata}
% \usepackage{amssymb}

% Hyperlinks
\usepackage{hyperref}
\definecolor{linkcolor}{HTML}{4f4fa3}
\hypersetup{%
	pdftitle=\doctitle,
	pdfauthor=\docauthor,
	colorlinks,
	linkcolor=linkcolor,
	citecolor=linkcolor,
	urlcolor=linkcolor,
	bookmarksnumbered=true
}

% Equation numbering
\numberwithin{equation}{chapter}

% Footnotes
\footmarkstyle{\textsuperscript{#1}\hspace{0.25em}}

% Mathematics
\usepackage{latex-sty/basicmathcommands}
\usepackage{latex-sty/framedtheorems}
\usepackage{latex-sty/topologycommands}
\usepackage{tikz-cd}
\tikzcdset{arrow style=math font} % https://tex.stackexchange.com/questions/300352/equalities-look-broken-with-tikz-cd-and-math-font
\usetikzlibrary{babel}

% Lists
\usepackage{enumitem}
\setenumerate[0]{label=\normalfont(\alph*)}
\setlist{  
  listparindent=\parindent,
  parsep=0pt,
}

% Bibliography
\usepackage[backend=biber, style=authoryear, maxcitenames=2, useprefix]{biblatex}
\addbibresource{references.bib}

% Title
\title{\doctitle}
\author{\docauthor}

\newcommand{\setF}{\mathbb{F}}
\newcommand{\ev}{\mathrm{ev}}
\newcommand{\calT}{\mathcal{T}}
\newcommand{\calU}{\mathcal{U}}
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calM}{\mathcal{M}}
\newcommand{\calA}{\mathcal{A}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calR}{\mathcal{R}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\strucS}{\mathfrak{S}}
\DeclarePairedDelimiter{\gen}{\langle}{\rangle} % Generating set
\newcommand{\frakL}{\mathfrak{L}}
\newcommand{\frakN}{\mathfrak{N}}
\newcommand{\frakA}{\mathfrak{A}}
\newcommand{\frakB}{\mathfrak{B}}
\newcommand{\ab}{\mathit{ab}}

\DeclareMathOperator{\im}{im}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\stab}{Stab}

% Categories
\newcommand{\cat}[1]{\mathcal{#1}}
\newcommand{\scat}[1]{\mathbf{#1}} % category supposed to be small
\newcommand{\ncat}[1]{\mathbf{#1}} % named categories like Set, Top

\newcommand{\catSet}{\ncat{Set}} % Category of sets
\newcommand{\catGrp}{\ncat{Grp}} % Category of groups
\newcommand{\catAb}{\ncat{Ab}} % Category of abelian groups
\newcommand{\catRing}{\ncat{Ring}} % Category of rings
\newcommand{\catFld}{\ncat{Fld}} % Category of fields

\newcommand{\catMod}[1]{{#1\text{-}\scat{Mod}}}
\newcommand{\catRMod}{\catMod{R}}

\newcommand{\End}{\mathrm{End}}
\newcommand{\Hom}{\mathrm{Hom}}

\DeclareMathOperator{\chr}{char}


%% Framed exercise environment

\mdfdefinestyle{swannexercise}{%
    skipabove=0.5em plus 0.4em minus 0.2em,
	skipbelow=0.5em plus 0.4em minus 0.2em,
	leftmargin=-5pt,
	rightmargin=-5pt,
	innerleftmargin=5pt,
	innerrightmargin=5pt,
	innertopmargin=5pt,
	innerbottommargin=4pt,
	linewidth=0pt,
	splittopskip=1.2em minus 0.2em,
	splitbottomskip=0.5em plus 0.2em minus 0.1em,
	backgroundcolor=backgroundcolor,
	frametitlebackgroundcolor=titlecolor,
	frametitlefont={\scshape},
    theoremseparator={},
    % theoremspace={},
	frametitleaboveskip=3pt,
	frametitlebelowskip=2pt
}

\mdtheorem[style=swannexercise]{exerciseframed}{Exercise}

\let\oldexerciseframed\exerciseframed
\renewcommand{\exerciseframed}{%
  \crefalias{theorem}{exerciseframed}%
  \oldexerciseframed}

\usepackage{listofitems}

\settocdepth{subsection}
\renewenvironment{exerciseframed}[1][]{%
    \setsepchar{.}%
    \readlist*\mylist{#1}%
    \def\smalllabel{\mylist[2].\mylist[3]}%
    \refstepcounter{exerciseframed}%
    % \addcontentsline{toc}{subsection}{Exercise \smalllabel}%
    \begin{exerciseframed*}[#1]%
    \label{ex:#1}%
}{%
    \end{exerciseframed*}%
}

% https://tex.stackexchange.com/a/23491/63353
\newcommand{\RNum}[1]{\uppercase\expandafter{\romannumeral #1\relax}}

\newcommand{\exref}[1]{%
    % \setsepchar{.}%
    % \readlist*\mylist{#1}%
    % \ifnum \arabic{chapter}=\mylist[1]
    %     \def\mylabel{\mylist[2].\mylist[3]}%
    % \else
    %     \def\mylabel{\RNum{\mylist[1]}.\mylist[2].\mylist[3]}%
    % \fi
    \hyperref[ex:#1]{Exercise~#1}%
}

\theoremstyle{nonumberplain}
\theoremsymbol{\ensuremath{\square}}
\newtheorem{solution}{Solution}

\let\oldsolution\solution
\renewcommand{\solution}{%
  \crefalias{theorem}{solution}%
  \oldsolution}

\newcommand{\solutionlabelfont}[1]{{\normalfont\color{linkcolor}#1}}
\newlist{solutionsec}{enumerate}{1}
\setlist[solutionsec]{leftmargin=0pt, parsep=0pt, listparindent=\parindent, font=\solutionlabelfont, label=(\alph*), labelsep=0pt, labelwidth=20pt, itemindent=20pt, align=left, itemsep=10pt}


% \renewcommand{\thechapter}{\Roman{chapter}}
% \renewcommand{\thesection}{\arabic{section}}

\DeclarePairedDelimiter{\ord}{\lvert}{\rvert}
\DeclareMathOperator{\lcm}{lcm}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Inn}{Inn}

\usepackage{caption} % Links to figures jump correctly
\Crefname{figure}{Figure}{Figures}


\newenvironment{displaytheorem}{%
	\begin{displayquote}\itshape%
}{%
	\end{displayquote}%
}


\newcommand{\upset}{\operatorname{\uparrow}}
\newcommand{\downset}{\operatorname{\downarrow}}
\newcommand{\matgroup}[3]{\mathrm{#1}_{#2}(#3)}
\newcommand{\GL}[2]{\matgroup{GL}{#1}{#2}}
\newcommand{\SL}[2]{\matgroup{SL}{#1}{#2}}
\newcommand{\catGSet}[1][G]{{#1\text{-}\catSet}}
\newcommand{\frakI}{\mathfrak{I}}
\newcommand{\field}{\mathbb{F}}
\let\bigcoprod\coprod
\renewcommand{\coprod}{\sqcup}


% TODO for logic
\renewcommand{\mylistlabelfont}[1]{{\normalfont\color{linkcolor}\textit{#1}:}}
\newlist{notelist}{description}{1}
\setlist[notelist]{leftmargin=0pt, parsep=0pt, listparindent=\parindent, font=\mylistlabelfont}


\begin{document}

\maketitle

\chapter{Ordered sets}

\newcommand{\catPos}{\ncat{Pos}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\dual}{^{\partial}}

\begin{remarkbreak}[Duality in ordered sets]
    We elaborate on the duality principle. Consider the elementary language $\calL_\catPos$ of ordered sets. This is a (single sorted) first-order language with identity, variable symbols $x, y, z, \ldots$ and a single binary relation symbol \enquote{$\leq$}. If $\phi$ is a wff of $\calL_\catPos$, then its \emph{dual} $\phi\dual$ is the wff obtained by reversing the order of all inequalities, so that \enquote{$X \leq Y$} becomes \enquote{$Y \leq X$}.
    
    Recall that a \emph{sentence} in a first-order language is a wff with no free variables. The duality principle then says the following:
    %
    \begin{displaytheorem}
        Let $\phi$ be a $\calL_\catPos$-sentence. If the order axioms entail $\phi$, then they also entail the dual claim $\phi\dual$.
    \end{displaytheorem}
    %
    In other words, if $\phi$ holds in all ordered sets, then so does $\phi\dual$. We give both a syntactic and a semantic proof of this claim. (Of course either is sufficient since the theory of ordered sets is a first-order theory.)

    First notice that the axioms of ordered sets (reflexivity, antisymmetry and transitivity) are self-dual: That is, each is their own dual. For instance, the transitive axiom states that
    %
    \begin{equation*}
        \forall x \forall y \forall z (x \leq y \land y \leq z \implies x \leq z),
    \end{equation*}
    %
    and this is obviously equivalent to its dual:
    %
    \begin{equation*}
        \forall x \forall y \forall z (y \leq x \land z \leq y \implies z \leq x).
    \end{equation*}
    %
    Now say that there is a (first-order) proof of $\phi$ from the order axioms. Then taking the dual of every wff in this proof yields a proof of the dual claim $\phi\dual$ from the duals of the order axioms. But these are themselves axioms, so the order axioms entail $\phi\dual$.

    For a semantic proof, say that $\phi$ holds in every ordered set $P$. Then $\phi\dual$ holds in every dual $P\dual$ of an ordered set. But these are precisely all the ordered sets, so $\phi\dual$ holds in all ordered sets.

    This obviously extends to set theories augmented with inequality.
\end{remarkbreak}

\begin{remark}
    An injective monotone map is not necessarily an order-embedding: For instance, the identity map $\iota \colon \overline{\mathbf{2}} \to \mathbf{2}$ is obviously injective, but it is not an embedding since $0 < 1$ in $\mathbf{2}$ but not in $\overline{\mathbf{2}}$.
\end{remark}


\begin{remarkbreak}[Order-isomorphisms]
    \label{rem:order-isomorphisms}
    Let $f \colon P \to Q$ be a monotone map. We claim that $f$ is an order-isomorphism if and only if it is bijective, and its inverse $f\inv$ is also monotone.

    First assume that $f$ is an order-isomorphism, let $u,v \in Q$, and let $x,y \in P$ such that $f(x) = u$ and $f(y) = v$. Then $f\inv(u) = x \leq y = f\inv(v)$ if and only if $u \leq v$, so $f\inv$ is monotone.

    Conversely assume that $f\inv$ exists and is monotone, and assume that $f(x) \leq f(y)$. Then $x = f\inv(f(x)) \leq f\inv(f(y)) = y$, so $f$ is an order-embedding, hence an order-isomorphism.
\end{remarkbreak}


\begin{remarkbreak}[The category of ordered sets]
    The category $\catPos$ of (partially) ordered sets has as objects posets and as arrows monotone maps. We claim that $\catPos$ has all small products and coproducts.

    Let $A$ be an index set, and let $(P_\alpha)_{\alpha \in A}$ be a collection of posets. We define an order on the Cartesian product $P = \bigprod_{\alpha \in A} P_\alpha$ by letting $(x_\alpha)_{\alpha \in A} \leq (y_\alpha)_{\alpha \in A}$ if and only if $x_\alpha \leq y_\alpha$ for all $\alpha \in A$. The projections $\pi_\alpha \colon P \to P_\alpha$ are then clearly monotone. Notice that the above definition means that for $x,y \in P$ we have $x \leq y$ if and only if $\pi_\alpha(x) \leq \pi_\alpha(y)$ for all $\alpha \in A$. Given monotone maps $\phi_\alpha \colon Q \to P_\alpha$, there is a unique \emph{set map} $\phi \colon Q \to P$ making the diagram
    %
    \begin{equation*}
        \begin{tikzcd}
            && P_\alpha \\
            Q
                \ar[r, "\phi", swap, dashed]
                \ar[urr, "\phi_\alpha", bend left]
            & P
                \ar[ur, "\pi_\alpha", swap]
        \end{tikzcd}
    \end{equation*}
    %
    commute for all $\alpha \in A$. But $\phi$ is clearly also monotone: For $x,y \in Q$ with $x \leq y$, since $\phi_\alpha$ is monotone we have 
    %
    \begin{equation*}
        \pi_\alpha(\phi(x))
            = \phi_\alpha(x)
            \leq \phi_\alpha(y)
            = \pi_\alpha(\phi(y)),
    \end{equation*}
    %
    so $\phi(x) \leq \phi(y)$.

    Next we define an order on the disjoint union $P = \bigcoprod_{\alpha \in A} P_\alpha$. Denoting the canonical injections by $\iota_\alpha \colon P_\alpha \to P$, each element in $P$ is on the form $\iota_\alpha(x)$ for precisely one $\alpha \in A$ and $x \in P_\alpha$. Given another element $\iota_\beta(y)$ in $P$, we thus let $\iota_\alpha(x) \leq \iota_\beta(y)$ if and only if $\alpha = \beta$ and $x \leq y$ in $P_\alpha$. Given monotone maps $\phi_\alpha \colon P_\alpha \to Q$, there is a unique \emph{set map} $\phi \colon P \to Q$ making the diagram
    %
    \begin{equation*}
        \begin{tikzcd}
            P_\alpha
                \ar[dr, "\iota_\alpha", swap]
                \ar[drr, "\phi_\alpha", bend left]
            \\
            & P
                \ar[r, "\phi", swap, dashed]
            & Q
        \end{tikzcd}
    \end{equation*}
    %
    commute for all $\alpha \in A$. But $\phi$ is clearly also monotone: If two elements in $P$ are comparable, then they are on the form $\iota_\alpha(x)$ and $\iota_\alpha(y)$ for a common $\alpha \in A$ and $x,y \in P_\alpha$. If $\iota_\alpha(x) \leq \iota_\alpha(y)$, then by definition we must have $x \leq y$ in $P_\alpha$. Since $\phi_\alpha$ is monotone it follows that
    %
    \begin{equation*}
        \phi(\iota_\alpha(x))
            = \phi_\alpha(x)
            \leq \phi_\alpha(y)
            = \phi(\iota_\alpha(y)),
    \end{equation*}
    %
    showing that $\phi$ is monotone.

    For finite coproducts we prefer the notation $P \coprod Q$.
\end{remarkbreak}


\begin{remarkbreak}[Linear sums of ordered sets]
    We may also define a (potentially) different order on the disjoint union $\bigcoprod_{\alpha \in A} P_\alpha$ in the case where the index set $A$ is itself (partially) ordered. For $x,y \in P$ we let $x \leq y$ if and only if
    %
    \begin{enumerate}
        \item $x,y \in P_\alpha$ for a common $\alpha \in A$, and $x \leq y$ in $P_\alpha$, or
        \item $x \in P_\alpha$ and $y \in P_\beta$ for distinct $\alpha,\beta \in A$ with $\alpha \leq \beta$.
    \end{enumerate}
    %
    We denote the disjoint union equipped with this order by $\bigoplus_{\alpha \in A} P_\alpha$. In the case where $A = \{1, \ldots n\}$ is finite and totally ordered (in the obvious way) we also write
    %
    \begin{equation*}
        P_1 \oplus \cdots \oplus P_n.
    \end{equation*}
    %
    Despite the additive notation, this operation is clearly \emph{not} commutative, even up to isomorphism.

    Notice that if $A$ has the discrete order, then the second clause above is never satisfied, and the order reduces to the coproduct order.
\end{remarkbreak}

\newcommand{\downsets}{\mathcal{O}}
\newcommand{\op}{^{\mathrm{op}}}

\begin{remarkbreak}[The functor $\downsets$]
    We claim that $\mathcal{O} \colon \catPos\op \to \catPos$ is a (contravariant) functor, when its action on arrows is given by $\mathcal{O}(\phi) = \phi\preim$, i.e. it is the pullback of $\phi$.

    \exref{1.24} shows that $\mathcal{O}$ is well-defined as a map between categories, and the identity
    %
    \begin{equation*}
        \mathcal{O}(\psi \circ \phi)
            = (\psi \circ \phi)\preim
            = \phi\preim \circ \psi\preim
            = \mathcal{O}(\phi) \circ \mathcal{O}(\psi),
    \end{equation*}
    %
    where $\circ$ denotes composition in $\catPos$ and not in $\catPos\op$, shows that it is indeed a functor (its action on identity arrows is obvious).
\end{remarkbreak}


\begin{exerciseframed}[1.24]
    Let $P$ and $Q$ be ordered sets.
    %
    \begin{enumerate}
        \item Show that $\phi \colon P \to Q$ is order-preserving if and only if $\phi\preim(A)$ is a down-set in $P$ whenever $A$ is a down-set in $Q$.
        
        \item Assume $\phi \colon P \to Q$ is order-preserving. Then, by (i), the map $\phi\preim \colon \downsets(Q) \to \downsets(P)$ is well defined.
        %
        \begin{enumerate}
            \item Show that $\phi$ is an order-embedding if and only if $\phi\preim$ maps $\downsets(Q)$ onto $\downsets(P)$.
            \item Show that $\phi$ maps onto $Q$ if and only if the map $\phi\preim \colon \downsets(Q) \to \downsets(P)$ is one-to-one.
        \end{enumerate}
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
\begin{solutionsec}
    \item First assume that $\phi$ is order-preserving, let $A \subseteq Q$ be a down-set, and let $x \in \phi\preim(A)$ and $y \in P$ with $y \leq x$. Then $\phi(y) \leq \phi(x)$, and since $\phi(x)$ lies in the down-set $A$ we also have $\phi(y) \in A$. Hence $y \in \phi\preim(A)$ as claimed.

    Conversely, let $x,y \in P$ with $x \leq y$. If $A$ is a down-set of $Q$ with $\phi(y) \in A$, then $y$ lies in the down-set $\phi\preim(A)$ in $P$. By Lemma~1.30, $x$ also lies in $\phi\preim(A)$, so $\phi(x) \in A$. The lemma then implies that $\phi(x) \leq \phi(y)$.

    \item Assume that $\phi$ is an order-embedding, and let $B \in \downsets(P)$. We claim that $B = \phi\preim(\downset \phi(B))$. The inclusion \enquote{$\subseteq$} is obvious, so let $x \in P$ with $\phi(x) \in \downset \phi(B)$. Then there is a $y \in B$ such that $\phi(x) \leq \phi(y)$, and this implies that $x \leq y$ since $\phi$ is an embedding. But then $x \in B$, proving the other inclusion, so $\phi\preim$ is surjective.
    
    Next assume that $\phi\preim$ is surjective, and consider $x,y \in P$ such that $\phi(x) \leq \phi(y)$. There is a down-set $A$ in $Q$ such that $\downset y = \phi\preim(A)$, so in particular $\phi(y) \in A$. But then $\phi(x) \in A$, so $x \in \downset y$. Hence $x \leq y$ as desired.

    Now assume that $\phi$ is surjective. For $A,B \subseteq Q$ we have
    %
    \begin{equation*}
        A
            = \phi(\phi\inv(A))
            = \phi(\phi\inv(B))
            = B,
    \end{equation*}
    %
    so $\phi\inv$ is injective even on the larger domain $\powerset{Q}$.

    Finally assume that $\phi$ is \emph{not} surjective, and choose an element $y \in Q$ not in the image of $\phi$. Then if $B \subseteq Q$ contains $y$, we have $\phi\inv(B) = \phi\inv(B \setminus \{y\})$, so $\phi\inv$ is not injective on the domain $\powerset{Q}$. Letting $B = \downset y$ we notice that $\downset y \setminus \{y\}$ is also a down-set, so $\phi\inv$ is also not injective on $\downsets(Q)$.
\end{solutionsec}
\end{solution}


\chapter{Lattices and complete lattices}

\newcommand{\catLat}{\ncat{Lat}}
\newcommand{\catCLat}{\ncat{CLat}}


\begin{remarkbreak}[Duality in lattices]
    We elaborate on the duality principle for lattices. Consider the elementary language $\calL_\catLat$ of lattices, which is an extension of $\calL_\catPos$: It further includes binary function symbols \enquote{$\join$} and \enquote{$\meet$} (not to be confused with the logical operators), which satisfy the axioms
    %
    \begin{equation*}
        \forall x \forall y \forall z \bigl[ (x \leq z) \land (y \leq z) \Leftrightarrow x \join y \leq z \bigr]
    \end{equation*}
    %
    and
    %
    \begin{equation*}
        \forall x \forall y \forall z \bigl[ (z \leq x) \land (z \leq y) \Leftrightarrow z \leq x \meet y \bigr].
    \end{equation*}
    %
    Notice that there is no uniqueness assumption in the above axioms. Of course, in any model the values of the functions corresponding to the symbols \enquote{$\join$} and \enquote{$\meet$} will be unique given arguments, and we may prove that the axioms above are satisfied only by these values.

    If $\phi$ is a wff of $\calL_\catLat$, then its \emph{dual} $\phi\dual$ is the wff obtained by reversing the order of all inequalities, as well as exchanging \enquote{$\join$} and \enquote{$\meet$}. Notice that the two axioms above are each other's duals.
    
    The duality principle for lattices says the following:
    %
    \begin{displaytheorem}
        Let $\phi$ be a $\calL_\catLat$-sentence. If the lattice axioms entail $\phi$, then they also entail the dual claim $\phi\dual$.
    \end{displaytheorem}
    %
    In other words, if $\phi$ holds in all lattices, then so does $\phi\dual$. This follows just as the duality principle for ordered sets, either syntactically or semantically.

    As with ordered sets, this extends to set theories as well.
\end{remarkbreak}


\begin{remarkbreak}[Order-isomorphisms and lattice isomorphisms]
    Proposition~2.19(i) says that a lattice homomorphism is also monotone. To show that a lattice isomorphism $f \colon L \to K$ is also an order-isomorphism, it suffices to recall \cref{rem:order-isomorphisms}: For both $f$ and $f\inv$ are lattice homomorphisms, hence monotone, so $f$ is an order-isomorphism. (The converse is proved in Proposition~2.19(ii).)
\end{remarkbreak}


\begin{remarkbreak}[The category of lattices]
    The category $\catLat$ is the subcategory of $\catPos$ whose objects are lattices and whose arrows are lattice homomorphisms. We claim that this has all small products [TODO coproducts?].

    Let $A$ be an index set, and let $(L_\alpha)_{\alpha \in A}$ be a collection of lattices. Then $L = \bigprod_{\alpha \in A} L_\alpha$ is a product in $\catPos$, and it is easy to show that $L$ is also a lattice, where the lattice operations are given coordinatewise, i.e.
    %
    \begin{equation*}
        (x_\alpha) \join (y_\alpha)
            = (x_\alpha \join y_\alpha)
        \quad \text{and} \quad
        (x_\alpha) \meet (y_\alpha)
            = (x_\alpha \meet y_\alpha).
    \end{equation*}
    %
    Furthermore, the projections $\pi_\alpha \colon L \to L_\alpha$ are also lattice homomorphisms, since if $x = (x_\alpha)$ and $y = (y_\alpha)$, then
    %
    \begin{equation*}
        \pi_\alpha(x \join y)
            = \pi_\alpha \bigl( (x_\alpha \join y_\alpha)_{\alpha \in A} \bigr)
            = x_\alpha \join y_\alpha
            = \pi_\alpha(x) \join \pi_\alpha(y),
    \end{equation*}
    %
    and similarly for meets. To show that $L$ is a product in $\catLat$, it thus suffices to show that a collection of lattice homomorphisms $f_\alpha \colon K \to L_\alpha$ factors uniquely through $L$. Uniqueness is clear, and the product map $f \colon K \to L$ is a lattice homomorphism since
    %
    \begin{align*}
        f(x \join y)
            &= \bigl( f_\alpha(x \join y) \bigr)_{\alpha \in A}
             = \bigl( f_\alpha(x) \join f_\alpha(y) \bigr)_{\alpha \in A} \\
            &= \bigl( f_\alpha(x) \bigr)_{\alpha \in A} \join \bigl( f_\alpha(y) \bigr)_{\alpha \in A}
             = f(x) \join f(y),
    \end{align*}
    %
    and similarly for meets.

    Denote by $\catCLat$ the (full) subcategory of $\catLat$ whose objects are complete lattices. This category also has all small products, since if $S \subseteq L = \bigprod_{\alpha \in A} L_\alpha$ with all $L_\alpha$ complete, then it is easy to show that
    %
    \begin{equation*}
        \bigjoin S
            = \bigl( \bigjoin \pi_\alpha(S) \bigr)_{\alpha \in A},
    \end{equation*}
    %
    and dually for meets.
\end{remarkbreak}


\begin{remarkbreak}[Linear sums of lattices]
    Let $(L_\alpha)_{\alpha \in A}$ be a collection of lattices, where the index set $A$ is itself a lattice. We wish to find further constraints on either $A$ or the $L_\alpha$ that ensure that the linear sum $L = \bigoplus_{\alpha \in A} L_\alpha$ is also a lattice.
    
    First assume that $A$ is totally ordered. For elements $x,y \in L$, say that $x,y \in L_\alpha$ for a common index $\alpha$. Then the join $x \join y$ in $L$ is simply the join of $x$ and $y$ in $L_\alpha$. If instead $x \in L_\alpha$ and $y \in L_\beta$ for distinct $\alpha,\beta \in A$, then
    %
    \begin{equation*}
        x \join y =
        \begin{cases}
            x, & \alpha > \beta, \\
            y, & \alpha < \beta.
        \end{cases}
    \end{equation*}
    %
    Meets are given dually. In particular, finite linear sums of lattices are themselves lattices.

    Next, instead assume that each $L_\alpha$ is bounded. Then if $x \in L_\alpha$ and $y \in L_\beta$ for $\alpha \neq \beta$, then $x \join y$ is the zero in $L_{\alpha \join \beta}$. Dually for meets.

    Finally we consider complete lattices. Assume that each $L_\alpha$ is complete, and that $A$ is also complete. Then $L$ is a lattice by the above, and we claim that it is also complete. Let $S \subseteq L$ and define
    %
    \begin{equation*}
        B
            = \set{\alpha \in A}{\pi_\alpha(S) \neq \emptyset}.
    \end{equation*}
    %
    Letting $\beta = \bigjoin B$ we have $\bigjoin S = \bigjoin \pi_\beta(S)$. Again we in particular see that finite linear sums of complete lattices are complete.
\end{remarkbreak}


\begin{remarkbreak}[Ideals and filters in posets]
    Ideals and filters may be defined more generally for a partially ordered set $(P,\leq)$. An \emph{ideal} in $P$ is a nonempty subset $I$ that is
    %
    \begin{enumerate}
        \item upward directed: for every $x,y \in I$ there is a $z \in I$ such that $x,y \leq z$; and
        \item downward closed (i.e. a down-set): for every $x \in P$ and $y \in I$, $x \leq y$ implies that $x \in I$.
    \end{enumerate}
    %
    Dually, a \emph{filter} in $P$ is a nonempty, downward directed up-set.

    If $P$ is also a lattice and $I$ is an ideal in the above sense, then it is also an ideal in the sense of Definition~2.20 (the converse is obvious). For if $x,y \in I$, then there is some $z \in I$ with $x,y \leq z$. But $x \join y \leq z$, so since $I$ is downward closed we also have $x \join y \in I$.
\end{remarkbreak}


\begin{remarkbreak}[Generating ideals and filters]
    If $P$ is a partially ordered set and $A \subseteq P$, then it is easy to show that $A$ is upward directed if and only if $\downset A$ is upward directed. Thus if $A \neq \emptyset$, then $\downset A$ is an ideal if and only if $A$ is upward directed, and dually for filters. Clearly $\downset A$ is the smallest ideal containing $A$ (compare \exref{2.22}).

    In topology it is common to consider filters in powerset lattices. All filters are usually assumed to be proper in this context. If $X$ is a set, then a \emph{prefilter} or \emph{filter basis} is a nonempty, downward directed collection $\calB$ of nonempty subsets of $X$. It generates the filter $\calF = \upset \calB$, and this is indeed proper since $\emptyset \not\in \calF$. By the above, a filter basis is precisely a collection $\calB \subseteq \powerset{X}$ such that $\upset \calB$ is a (proper) filter.
\end{remarkbreak}


\begin{exerciseframed}[2.6]
    Let $P$ be an ordered set.
    %
    \begin{enumerate}
        \item Prove that if $A \subseteq P$ and $\bigmeet A$ exists in $P$, then
        %
        \begin{equation*}
            \bigintersect \set{\downset a}{a \in A}
                = \downset \bigl( \bigmeet A \bigr).
        \end{equation*}

        \item Formulate and prove the dual result.
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
\begin{solutionsec}
    \item This is obvious, since $x \leq a$ for all $a \in A$ if and only if $x \leq \bigmeet A$.

    \item The dual result is
    %
    \begin{equation*}
        \bigintersect \set{\upset a}{a \in A}
            = \upset \bigl( \bigjoin A \bigr),
    \end{equation*}
    %
    whenever $\bigjoin A$ exists in $P$. This follows by duality or by an argument analogous to the above.
\end{solutionsec}
\end{solution}


\begin{exerciseframed}[2.17]
    Let $L$ and $K$ be lattices with $0$ and $1$. Show that there exist $a,b \in L \prod K$ such that
    %
    \begin{enumerate}
        \item $\downset a \cong L$ and $\downset b \cong K$,
        \item $a \meet b = (0, 0)$ and $a \join b = (1, 1)$.
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
    Let $a = (1,0)$ and $b = (0,1)$. Then
    %
    \begin{equation*}
        \downset (1,0)
            = \set{(x,y) \in L \prod K}{x \leq 1, y \leq 0}
            = L \prod \{0\}.
    \end{equation*}
    %
    The map $x \mapsto (x,0)$ is clearly an isomorphism\footnote{Indeed, if $c \in K$ is any fixed element, then the map $L \to L \prod K$ given by $x \mapsto (x,c)$ is an injective homomorphism.} $L \to L \prod \{0\}$, proving that $\downset(1,0) \cong L$. Similarly we find that $\downset (0,1) \cong K$.

    Furthermore notice that
    %
    \begin{equation*}
        (1,0) \meet (0,1)
            = (1 \meet 0, 0 \meet 1)
            = (0,0)
    \end{equation*}
    %
    and
    %
    \begin{equation*}
        (1,0) \join (0,1)
            = (1 \join 0, 0 \join 1)
            = (1,1)
    \end{equation*}
    %
    as desired.
\end{solution}


\begin{exerciseframed}[2.22]
    Let $L$ be a lattice and let $\emptyset \neq A \subseteq L$. Show that
    %
    \begin{equation*}
        (A] \defn \downset \set{ a_1 \join \cdots \join a_n }{ n \in \naturals, a_1, \ldots, a_n \in A }
    \end{equation*}
    %
    is an ideal and moreover it is contained in any ideal $J$ of $L$ which contains $A$.
\end{exerciseframed}

\begin{solution}
    Clearly $(A]$ is a down-set, so it suffices to show that it is closed under binary joins. If $x,y \in (A]$, then by definition there exist $a_1, \ldots, a_n, b_1, \ldots, b_m \in A$ such that
    %
    \begin{equation*}
        x
            \leq a_1 \join \cdots \join a_n
        \quad \text{and} \quad
        y
            \leq b_1 \join \cdots \join b_m.
    \end{equation*}
    %
    It follows that
    %
    \begin{equation*}
        x \join y
            \leq a_1 \join \cdots \join a_n \join b_1 \join \cdots \join b_m,
    \end{equation*}
    %
    so $x \join y \in (A]$.

    To show that $(A] \subseteq J$, notice that it suffices (since $J$ is a down-set) to show that all finite joins of elements in $A$ lie in $J$. But this is obvious since $A \subseteq J$ and $J$ is an ideal.
\end{solution}


\begin{exerciseframed}[2.29]
    Let $P$ be a complete lattice. Prove that there is a topped $\intersect$-structure $\frakL$ on the set $P$ such that $P \cong \frakL$.
\end{exerciseframed}

\begin{solution}
    Consider the map $\phi \colon P \to \downsets(P)$ given by $\phi(x) = \downset x$. This is clearly an order-embedding, so restricting its codomain to its image $\frakL \defn \phi(P)$ yields an order isomorphism, hence a lattice isomorphism. It remains to be shown that $\frakL$ is a topped $\intersect$-structure.

    Clearly $\frakL$ is topped since $P = \downset 1$, so it suffices to show that it is an $\intersect$-structure. Let $\{A_i\}_{i \in I}$ be a nonempty family of elements in $\frakL$, and write $A_i = \downset x_i$ for appropriate $x_i \in P$. Now notice that \exref{2.6} implies that
    %
    \begin{equation*}
        \bigintersect_{i \in I} A_i
            = \bigintersect_{i \in I} \downset x_i
            = \downset \Bigl( \bigmeet_{i \in I} x_i \Bigr)
            \in \frakL
    \end{equation*}
    %
    as desired.
\end{solution}

\newcommand{\Sub}{\operatorname{Sub}}

\begin{exerciseframed}[2.31]
    Let $G_1$ and $G_2$ be finite groups such that $\gcd(\card{G_1}, \card{G_2}) = 1$. Show that
    %
    \begin{equation*}
        \Sub(G_1 \prod G_2) \cong \Sub G_1 \prod \Sub G_2,
    \end{equation*}
    %
    where on the left we have the usual coordinatewise product of groups and on the right the coordinatewise product of ordered sets.
\end{exerciseframed}

\begin{solution}
    Write $n_i = \card{G_i}$. If $H$ is a subgroup of $G_1 \prod G_2$, then $\card{H} = k_1 k_2$ with $k_i \mid n_i$. Consider the subgroups $H_i = \pi_i(H)$ of $G_i$. Then $\card{H_i}$ divides both $n_i$ and $\card{H}$, so since $\gcd(n_1,n_2) = 1$ it divides $k_i$. It follows that $\card{H_1 \prod H_2} \leq k_1 k_2 = \card{H}$, and the opposite inequality follows since $H \subseteq H_1 \prod H_2$. Hence this inclusion is in fact an equality, so the map
    %
    \begin{align*}
        \Sub(G_1 \prod G_2) &\to \Sub G_1 \prod \Sub G_2, \\
        H &\mapsto \pi_1(H) \prod \pi_2(H),
    \end{align*}
    %
    is a bijection. It is also clearly monotone, proving the claim.
\end{solution}

\newcommand{\sgn}{\mathrm{sgn}}
% TODO: cycle notation

\begin{remark}
    The assumption that $\card{G_1}$ and $\card{G_2}$ be relatively prime is necessary. This hinges on the fact that a subgroup of a product is not necessarily a product of subgroups of each factor. For instance, the subgroup $\gen{(1,1)}$ of $\ints/2\ints \prod \ints/2\ints$ is clearly not a product of subgroups. It is, however, isomorphic to the subgroup $\ints/2\ints \prod \{0\}$, but we can find examples of subgroups of products that are not even isomorphic to any product of subgroups:

    Consider for instance the subgroup of $S_3 \prod S_3$ given by the kernel $K$ of the homomorphism $\phi \colon S_3 \prod S_3 \to \{\pm 1\}$ given by $\phi(g,h) = \sgn(gh)$. Since $\phi$ is surjective we have $[S_3 \prod S_3 : K] = 2$, so $\card{K} = 18$. Now assume towards a contradiction that $K$ is isomorphic to a product of two subgroups of $S_3$. By Lagrange's theorem, the possible orders of such a subgroup are $1,2,3,6$. Hence one factor must be $S_3$ itself, and the other must be of order $3$, i.e. it must be $A_3$. Hence $K \cong S_3 \prod A_3$. Now notice that $S_3 \prod A_3$ contains an element of order $6$, e.g. $((1\,2), (1\,2\,3))$, but $K$ does not: For an element of order $6$ in $S_3 \prod S_3$ must be a pair $(\tau,\sigma)$, where $\tau$ is a transposition and $\sigma$ a $3$-cycle, and $\sgn(\tau\sigma) = -1$.
\end{remark}


\begin{exerciseframed}[2.32]
    \begin{enumerate}
        \item Use the Knaster--Tarski Fixpoint Theorem to prove Banach's Decomposition Theorem:
        %
        \begin{displaytheorem}
            Let $X$ and $Y$ be sets and let $f \colon X \to Y$ and $g \colon Y \to X$ be maps. Then there exist disjoint subsets $X_1$ and $X_2$ of $X$ and disjoint subsets $Y_1$ and $Y_2$ of $Y$ such that $f(X_1) = Y_1$, $g(Y_2) = X_2$, $X = X_1 \union X_2$ and $Y = Y_1 \union Y_2$.
        \end{displaytheorem}

        \item Use (i) to obtain the Schröder--Bernstein Theorem:
        %
        \begin{displaytheorem}
            Let $X$ and $Y$ be sets and suppose there exist one-to-one maps $f \colon X \to Y$ and $g \colon Y \to X$. Then there exists a bijective map $h$ from $X$ onto $Y$.
        \end{displaytheorem}
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
\begin{solutionsec}
    \item Consider the map $F \colon \powerset{X} \to \powerset{X}$ given by $F(S) = X \setminus g(Y \setminus f(S))$. This is easily seen to be monotone, so the Knaster--Tarski fixpoint theorem yields the existence of a fixpoint $X_1 \subseteq X$. Letting $Y_1 = f(X_1)$, $Y_2 = Y \setminus Y_1$ and $X_2 = g(Y_2)$, the fact that $F(X_1) = X_1$ implies that
    %
    \begin{equation*}
        X_1
            = X \setminus g(Y \setminus f(X_1))
            = X \setminus g(Y \setminus Y_1)
            = X \setminus g(Y_2)
            = X \setminus X_2,
    \end{equation*}
    %
    which proves the claim.

    \item Let $X_1, X_2, Y_1, Y_2$ be a Banach decomposition. Since $g$ is injective it restricts to a bijection from $Y_2$ onto $X_2$. Let $g\inv$ denote the inverse of this restriction and define $h$ by
    %
    \begin{equation*}
        h(x) =
        \begin{cases}
            f(x),       & x \in X_1, \\
            g\inv(x),   & x \in X_2.
        \end{cases}
    \end{equation*}
    %
    This is easily seen to be both injective and surjective.
\end{solutionsec}
\end{solution}


\begin{exerciseframed}[2.34]
    Prove that $P \prod Q$ satisfies (ACC) if and only if both $P$ and $Q$ do.
\end{exerciseframed}

\begin{solution}
    Assume that $P$ and $Q$ satisfy (ACC), and let
    %
    \begin{equation*}
        (x_1,y_1)
            \leq (x_2,y_2)
            \leq \cdots
            \leq (x_n,y_n)
            \leq \cdots
    \end{equation*}
    %
    be a sequence in $P \prod Q$. By definition of the product order, this implies that $x_1 \leq x_2 \leq \cdots$ and $y_1 \leq y_2 \leq \cdots$. But then there exist $k_1,k_2 \in \naturals$ such that $x_{k_1} = x_{k_1+1} = \ldots$ and $y_{k_2} = y_{k_2+1} = \ldots$. Letting $k = \max\{k_1,k_2\}$ we thus have
    %
    \begin{equation*}
        (x_k,y_k)
            = (x_{k+1},y_{k+1})
            = \ldots,
    \end{equation*}
    %
    so $P \prod Q$ also satisfies (ACC).

    Conversely, assume that $P \prod Q$ satisfies (ACC), and let $x_1 \leq x_2 \leq \cdots$ be a sequence in $P$. If $y$ is any element of $Q$, this implies that $(x_1,y) \leq (x_2,y) \leq \cdots$ in $P \prod Q$. Hence we must have $x_k = x_{k+1} = \ldots$ for some $k \in \naturals$, so $P$ satisfies (ACC). Obviously so does $Q$.
\end{solution}


\newcommand{\length}{\ell}

\begin{exerciseframed}[2.35]
    Let $P$ and $Q$ be ordered sets of finite length. Prove that
    %
    \begin{equation*}
        \length(P \prod Q)
            = \length(P) + \length(Q).
    \end{equation*}
\end{exerciseframed}

\begin{solution}
    Write $n = \length(P)$ and $m = \length(Q)$ and let $x_0 < x_1 < \cdots < x_n$ and $y_0 < y_1 < \cdots y_m$ be chains in $P$ and $Q$ respectively. Then
    %
    \begin{equation*}
        (x_0,y_0)
            < (x_1,y_0)
            < \cdots
            < (x_n,y_0)
            < (x_n,y_1)
            < \cdots
            < (x_n,y_m)
    \end{equation*}
    %
    is a chain in $P \prod Q$ of length $n+m$, so $\length(P \prod Q) \geq n+m$. To prove the other inequality, let
    %
    \begin{equation*}
        (x_0,y_0)
            < (x_1,y_1)
            < \cdots
            < (x_k,y_k)
    \end{equation*}
    %
    be a chain in $P \prod Q$ of length $k$. For each $i = 1, \ldots, k$ we must have either $x_{i-1} < x_i$ or $y_{i-1} < y_i$. Let $I$ be the set of $i$ such that the former holds, and let $J$ be the set of $i$ such that the latter holds. Then $\set{x_i}{i \in I}$ is a chain in $P$ of length $\card{I}$, and $\set{y_i}{i \in J}$ is a chain in $Q$ of length $\card{J}$, so we must have $\card{I} \leq n$ and $\card{J} \leq m$. Since each $i$ lies in either $I$ or $J$ we have
    %
    \begin{equation*}
        k
            \leq \card{I} + \card{J}
            \leq n + m,
    \end{equation*}
    %
    which implies that $\length(P \prod Q) \leq n + m$ as desired.
\end{solution}


\begin{exerciseframed}[2.37]
    Let $L$ be a lattice.
    %
    \begin{enumerate}
        \item Let $J_1 \subseteq J_2 \subseteq \cdots$ be a chain of ideals of $L$. Show that their union $\bigunion_{n \in \naturals} J_n$ is an ideal of $L$.
        \item Show that every ideal of $L$ is principal if and only if $L$ satisfies (ACC).
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
\begin{solutionsec}
    \item If $a,b \in J = \bigunion_{n \in \naturals} J_n$, then $a \in J_n$ and $b \in J_m$ for some $n,m \in \naturals$. But then $a,b \in J_{n \join m} \subseteq J$ as required. Furthermore, if $a \in L$ and $b \in J_m$ with $a \leq b$, then $a \in J_m \subseteq J$.
    
    \item First assume that every ideal in $L$ is principal, and let $x_1 \leq x_2 \leq \cdots$ be a chain in $L$. Then there is an inclusion $\downset x_1 \subseteq \downset x_2 \subseteq \cdots$ of ideals, and the above shows that $J = \bigunion_{n\in\naturals} (\downset x_n)$ is also an ideal. Thus there is an $a \in L$ such that $J = \downset a$. But then $a \in \downset x_n$ for some $n \in \naturals$, and since $a$ is the maximum of $J$ we must have $a = x_n$. Hence this chain is of finite length.
    
    Now assume that $L$ satisfies (ACC) and let $J$ be an ideal in $L$. By Lemma~2.39, $J$ has a maximal element $a$. If $x \in J$, then since $J$ is an ideal we have $x \join a \in J$. Obviously $a \leq x \join a$, and since $a$ is maximal in $J$ we also have $x \join a \leq a$, so $x \join a = a$. Hence $x \leq a$, so $a$ is in fact the maximum of $J$. It follows that $J \subseteq \downset a$, and the opposite inequality is obvious by minimality of $\downset a$.
\end{solutionsec}
\end{solution}


\chapter{Formal concept analysis}

\chapter{Modular, distributive and Boolean lattices}

\begin{exerciseframed}[4.9]
    Let $L$ be a distributive lattice and let $a,b,c \in L$. Prove that
    \begin{equation*}
        (a \join b = c \join b \text{ and } a \meet b = c \meet b)
            \quad \implies \quad a = c.
    \end{equation*}
\end{exerciseframed}

\begin{solution}
    This follows from the calculation
    %
    \begin{align*}
        a
            &= a \meet (a \join b) \\
            &= a \meet (c \join b) \\
            &= (a \meet c) \join (a \meet b) \\
            &= (a \meet c) \join (c \meet b) \\
            &= c \meet (a \join b) \\
            &= c \meet (c \join b) \\
            &= c.
    \end{align*}
\end{solution}


\begin{exerciseframed}[4.12]
    \begin{enumerate}
        \item Prove that a lattice $L$ is distributive if and only if for each $a \in L$, the map $f_a \colon L \to \downset a \prod \upset a$ defined by
        %
        \begin{equation*}
            f_a(x)
                = (x \meet a, x \join a)
                \quad \text{for all $x \in L$}
        \end{equation*}
        %
        is a one-to-one homomorphism.

        \item Prove that, if $L$ is distributive and possesses 0 and 1, then $f_a$ is an isomorphism if and only if $a$ has
        a complement in $L$.
    \end{enumerate}
\end{exerciseframed}

\begin{solution}
\begin{solutionsec}
    \item First assume that $L$ is distributive and fix $a \in L$. For $x,y \in L$ we then have
    %
    \begin{align*}
        f_a(x \meet y)
            &= \bigl( (x \meet y) \meet a, (x \meet y) \join a \bigr) \\
            &= \bigl( (x \meet a) \meet (y \meet a), (x \join a) \meet (y \join a) \bigr) \\
            &= (x \meet a, x \join a) \meet (y \meet a, y \join a) \\
            &= f_a(x) \meet f_a(y),
    \end{align*}
    %
    and similarly for joins. Thus $f_a$ is a homomorphism. Injectivity follows immediately from \exref{4.9}.

    Conversely, given $a,b,c \in L$ and using that $f_a$ is a homomorphism, it follows that
    %
    \begin{equation*}
        f_a \bigl( (a \meet b) \join (a \meet c) \bigr)
            = \bigl( (a \meet b) \join (a \meet c), a \bigr),
    \end{equation*}
    %
    and that
    %
    \begin{equation*}
        f_a \bigl( a \meet (b \join c) \bigr)
            = \bigl( a \meet ((a \meet b) \join (a \meet c)), a \bigr)
            = \bigl( (a \meet b) \join (a \meet c), a \bigr),
    \end{equation*}
    %
    where the second equality follows since $(a \meet b) \join (a \meet c) \leq a$. Distributivity then follows since $f_a$ is injective.

    \item Since $f_a$ is already shown to be an injective homomorphism, it is an isomorphism if and only if it is surjective. First, if $f_a$ is surjective then there exists a $b \in L$ such that
    %
    \begin{equation*}
        (0,1)
            = f_a(b)
            = (b \meet a, b \join a),
    \end{equation*}
    %
    which precisely says that $b$ is a complement of $a$.

    Conversely, say that $a$ has a complement $a'$ in $L$, and let $c \in \downset a$ and $d \in \upset a$. Then $c \leq d$, so since $L$ is modular we have
    %
    \begin{equation*}
        x
            \defn c \join (a' \meet d)
            = (c \join a') \meet d.
    \end{equation*}
    %
    We furthermore have
    %
    \begin{equation*}
        \bigl( (c \join a') \meet d \bigr) \meet a
            = \bigl( (c \meet a) \join (a' \meet a) \bigr) \meet d
            = (c \join 0) \meet d
            = c
    \end{equation*}
    %
    and
    %
    \begin{equation*}
        \bigl( c \join (a' \meet d ) \bigr) \join a
            = c \join \bigl( (a' \join a) \meet (d \join a) \bigr)
            = a \join (1 \meet d)
            = d.
    \end{equation*}
    %
    Hence $f_a(x) = (c,d)$, so $f_a$ is surjective.
\end{solutionsec}
\end{solution}


\end{document}